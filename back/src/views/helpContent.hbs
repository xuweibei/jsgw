{{#>default}}
    <div class="department-help-content">
        <div class="help-content-top">底部栏</div>
        <div class="content-bottom-right">
            <div class="content-bottom-right-dinwei">
                <input type="file" id="Bank-card-photo" class="click-img-inp"/>
            </div>
            <img class="bottom-right-img" src="../assets/img/login-bg.png" alt="">
        </div>
        <div class="help-content-bottom">
            <div class="content-bottom-left">
                <div class="text-wrap">
                    <div class="text-wrap-list">
                        <div class="text-wrap-top">联络我们</div>
                        <div class="text-wrap-wrap">
                            <div class="title-name">公司简称：</div>
                            <input id="companyName" class="title-input" type="text" placeholder="请输入">
                        </div>
                        <div class="text-wrap-wrap">
                            <div class="title-name">联络方式：</div>
                            <input id="contactInfo" class="title-input" type="number" placeholder="请输入">
                        </div>
                        <div class="text-wrap-wrap">
                            <div class="title-name">联络地址：</div>
                            <input id="contactAddress" class="title-input" type="text" placeholder="请输入">
                        </div>
                    </div>
                </div>
                <div class="text-wrap">
                    <div class="text-wrap-list">
                        <div class="text-wrap-top">联络我们</div>
                        <div class="text-wrap-wrap">
                            <div class="title-name">页面名称：</div>
                            <input id="myPageName" class="title-input" type="text" placeholder="请输入">
                        </div>
                        <div class="text-wrap-wrap">
                            <div class="title-name">跳转链接：</div>
                            <input id="mySkipJoin" class="title-input" type="text" placeholder="请输入">
                        </div>
                    </div>

                    <div class="text-wrap-list list-item" id="list-shop1">
                        <div class="text-wrap-wrap">
                            <div class="title-name">页面名称：</div>
                            <input id="myPageName1" class="title-input" type="text" placeholder="请输入">
                        </div>
                        <div class="text-wrap-wrap">
                            <div class="title-name">跳转链接：</div>
                            <input id="mySkipJoin1" class="title-input" type="text" placeholder="请输入">
                        </div>
                    </div>

                    <div class="text-wrap-list list-item" id="list-shop2">
                        <div class="text-wrap-wrap">
                            <div class="title-name">页面名称：</div>
                            <input id="myPageName2" class="title-input" type="text" placeholder="请输入">
                        </div>
                        <div class="text-wrap-wrap">
                            <div class="title-name">跳转链接：</div>
                            <input id="mySkipJoin2" class="title-input" type="text" placeholder="请输入">
                        </div>
                    </div>

                    <div class="text-wrap-list list-item" id="list-shop3">
                        <div class="text-wrap-wrap">
                            <div class="title-name">页面名称：</div>
                            <input id="myPageName3" class="title-input" type="text" placeholder="请输入">
                        </div>
                        <div class="text-wrap-wrap">
                            <div class="title-name">跳转链接：</div>
                            <input id="mySkipJoin3" class="title-input" type="text" placeholder="请输入">
                        </div>
                    </div>

                    <div class="text-wrap-list list-item" id="list-shop4">
                        <div class="text-wrap-wrap">
                            <div class="title-name">页面名称：</div>
                            <input id="myPageName4" class="title-input" type="text" placeholder="请输入">
                        </div>
                        <div class="text-wrap-wrap">
                            <div class="title-name">跳转链接：</div>
                            <input id="mySkipJoin4" class="title-input" type="text" placeholder="请输入">
                        </div>
                    </div>

                    <div class="text-wrap-list list-item" id="list-shop5">
                        <div class="text-wrap-wrap">
                            <div class="title-name">页面名称：</div>
                            <input id="myPageName5" class="title-input" type="text" placeholder="请输入">
                        </div>
                        <div class="text-wrap-wrap">
                            <div class="title-name">跳转链接：</div>
                            <input id="mySkipJoin5" class="title-input" type="text" placeholder="请输入">
                        </div>
                    </div>
                    <div class="press-button">
                        <div class="button-left add-list">+</div>
                        <div class="button-left reduce-list">-</div>
                    </div>
                </div>

                <div class="text-wrap">
                    <div class="text-wrap-list">
                        <div class="text-wrap-top">友情链接</div>
                        <div class="text-wrap-wrap">
                            <div class="title-name">页面名称：</div>
                            <input id="friendPageName" class="title-input" type="text" placeholder="请输入">
                        </div>
                        <div class="text-wrap-wrap">
                            <div class="title-name">跳转链接：</div>
                            <input id="friendSkipJoin" class="title-input" type="text" placeholder="请输入">
                        </div>
                    </div>

                    <div class="text-wrap-list list-item" id="list-shop-bottom1">
                        <div class="text-wrap-wrap">
                            <div class="title-name">页面名称：</div>
                            <input id="friendPageName1" class="title-input" type="text" placeholder="请输入">
                        </div>
                        <div class="text-wrap-wrap">
                            <div class="title-name">跳转链接：</div>
                            <input id="friendSkipJoin1" class="title-input" type="text" placeholder="请输入">
                        </div>
                    </div>
                    <div class="press-button">
                        <div class="button-left add-list-bottom">+</div>
                        <div class="button-left reduce-list-bottom">-</div>
                    </div>
                </div>
                <div class="text-wrap">
                    <div class="text-wrap-list">
                        <div class="text-wrap-top">关注我们</div>
                        <div class="content-bottom-right-dinwei">
                            <input type="file" id="Bank-card-photos" class="click-img-inp"/>
                            <img id="img3" class="bottom-right-imgs" src="../assets/img/login-bg.png" alt="">
                        </div>
                    </div>
                </div>
                <div id="sumbit" class="preserve">保存</div>
            </div>
        </div>
        <script src="../assets/js/jquery-3.4.1.min.js"></script>
        <script src="../assets/js/bootstrap.min.js"></script>
        <script>
            $(function() {
                //定义变量
                let state = {
                    companyName: '', //公司名称
                    contactInfo: '', //联络方式
                    contactAddress: '', //联络地址
                    myPageName: '', //联系我们 页面名称
                    myPageName1: '', //联系我们 页面名称1
                    myPageName2: '', //联系我们 页面名称2
                    myPageName3: '', //联系我们 页面名称3
                    myPageName4: '', //联系我们 页面名称4
                    myPageName5: '', //联系我们 页面名称5
                    mySkipJoin: '',  //联系我们 跳转链接
                    mySkipJoin1: '', //联系我们 跳转链接1
                    mySkipJoin2: '', //联系我们 跳转链接2
                    mySkipJoin3: '', //联系我们 跳转链接3
                    mySkipJoin4: '', //联系我们 跳转链接4
                    mySkipJoin5: '', //联系我们 跳转链接5
                    friendPageName: '', //友情链接 页面名称
                    friendPageName1: '', //友情链接 页面名称1
                    friendSkipJoin: '', //友情链接 跳转链接
                    friendSkipJoin1: '', //友情链接 跳转链接1
                    listNum: 0, //增加减少 （联络我们）
                    listNums: 0, //增加减少 （友情链接）
                    facadeImg: '', //logo图片路径
                    facadeImgUrl: '', //二维码图片保存
                };

                //获取初始值
                $.post(
                    url.getCententTitle,
                    function(res) {
                        if (res) {
                            if (res.data) {
                                $('#companyName').val(res.data[0].comp_name);//公司名称
                                state.companyName = res.data[0].comp_name; //公司名称
                                $('#contactInfo').val(res.data[0].link_phone);//联络方式
                                state.contactInfo = res.data[0].link_phone; //联络方式
                                $('#contactAddress').val(res.data[0].address);//联络地址
                                state.contactAddress = res.data[0].address; //联络地址
                                $('#myPageName').val(res.data[1].page_name);//联系我们 页面名称
                                state.myPageName = res.data[1].page_name; //联系我们 页面名称
                                $('#mySkipJoin').val(res.data[1].page_link);//联系我们 页面名称
                                state.mySkipJoin = res.data[1].page_link; //联系我们 页面名称
                                $('#myPageName1').val(res.data[2].page_name);//联系我们 页面名称1
                                state.myPageName1 = res.data[2].page_name; //联系我们 页面名称1
                                $('#mySkipJoin1').val(res.data[2].page_link);//联系我们 页面名称1
                                state.mySkipJoin1 = res.data[2].page_link; //联系我们 页面名称1
                                $('#myPageName2').val(res.data[3].page_name);//联系我们 页面名称2
                                state.myPageName2 = res.data[3].page_name; //联系我们 页面名称2
                                $('#mySkipJoin2').val(res.data[3].page_link);//联系我们 页面名称2
                                state.mySkipJoin2 = res.data[3].page_link; //联系我们 页面名称2
                                $('#myPageName3').val(res.data[4].page_name);//联系我们 页面名称3
                                state.myPageName3 = res.data[4].page_name; //联系我们 页面名称3
                                $('#mySkipJoin3').val(res.data[4].page_link);//联系我们 页面名称3
                                state.mySkipJoin3 = res.data[4].page_link; //联系我们 页面名称3
                                $('#myPageName4').val(res.data[5].page_name);//联系我们 页面名称4
                                state.myPageName4 = res.data[5].page_name; //联系我们 页面名称4
                                $('#mySkipJoin4').val(res.data[5].page_link);//联系我们 页面名称4
                                state.mySkipJoin4 = res.data[5].page_link; //联系我们 页面名称4
                                $('#myPageName5').val(res.data[6].page_name);//联系我们 页面名称5
                                state.myPageName5 = res.data[6].page_name; //联系我们 页面名称5
                                $('#mySkipJoin5').val(res.data[6].page_link);//联系我们 页面名称5
                                state.mySkipJoin5 = res.data[6].page_link; //联系我们 页面名称5
                                $('#friendSkipJoin').val(res.data[7].friend_link);//友情链接 页面名称
                                state.friendSkipJoin = res.data[7].friend_link; //友情链接 页面名称
                                $('#friendPageName').val(res.data[7].friend_page);//友情链接 页面名称
                                state.friendPageName = res.data[7].friend_page; //友情链接 页面名称
                                $('#friendSkipJoin1').val(res.data[8].friend_link);//友情链接 页面名称1
                                state.friendSkipJoin1 = res.data[8].friend_link; //友情链接 页面名称1
                                $('#friendPageName1').val(res.data[8].friend_page);//友情链接 页面名称1
                                state.friendPageName1 = res.data[8].friend_page; //友情链接 页面名称1
                            }
                        }
                    })

                //获取input内容
                $('input').bind('input propertychange', function(e){
                    const name = e.currentTarget.id; //获取input id名称
                    console.log(name + 'name');
                    state[name] = $(`#${name}`).val();   //赋值input 内容
                });

                //增加按钮
                $('.add-list').bind('click', function() {
                    if (state.listNum >= 5) {
                        alert('最大数为6')
                    } else {
                        state.listNum += 1;
                        $(`#list-shop${state.listNum}`).css('display', 'block');
                        $(`.reduce-list`).css({'border-color': 'rgba(10, 175, 222, 1)', 'color': 'rgba(10, 175, 222, 1)'});
                        if (state.listNum >= 5) {
                            $(`.add-list`).css({'border-color': '#666666', 'color': '#666666'});
                        }
                    }
                });

                //减少按钮
                $('.reduce-list').bind('click', function() {
                    if (state.listNum <= 0) {
                        alert('最小数为0')
                    } else {
                        $(`#list-shop${state.listNum}`).css('display', 'none');
                        state.listNum -= 1;
                        $(`.add-list`).css({'border-color': 'rgba(10, 175, 222, 1)', 'color': 'rgba(10, 175, 222, 1)'});
                        if (state.listNum <= 0) {
                            $(`.reduce-list`).css({'border-color': '#666666', 'color': '#666666'});
                        }
                    }
                });

                //增加按钮底部
                $('.add-list-bottom').bind('click', function() {
                    if (state.listNums >= 1) {
                        alert('最大数为2')
                    } else {
                        state.listNums += 1;
                        $(`#list-shop-bottom${state.listNums}`).css('display', 'block');
                        $(`.reduce-list-bottom`).css({'border-color': 'rgba(10, 175, 222, 1)', 'color': 'rgba(10, 175, 222, 1)'});
                        if (state.listNums >= 1) {
                            $(`.add-list-bottom`).css({'border-color': '#666666', 'color': '#666666'});
                        }
                    }
                });

                //减少按钮底部
                $('.reduce-list-bottom').bind('click', function() {
                    if (state.listNums <= 0) {
                        alert('最小数为0')
                    } else {
                        $(`#list-shop-bottom${state.listNums}`).css('display', 'none');
                        state.listNums -= 1;
                        $(`.add-list-bottom`).css({'border-color': 'rgba(10, 175, 222, 1)', 'color': 'rgba(10, 175, 222, 1)'});
                        if (state.listNums <= 0) {
                            $(`.reduce-list-bottom`).css({'border-color': '#666666', 'color': '#666666'});
                        }
                    }
                });

                //logo图片上传
                $("#Bank-card-photo").change(function(e) {
                    var imgBox = e.target;
                    uploadImg('#Bank-card-photo', imgBox)
                });

                //二维码图片上传图片上传
                $("#Bank-card-photos").change(function(e) {
                    var imgBox = e.target;
                    uploadImg('#Bank-card-photos', imgBox)
                });

                //公用上传图片方法
                function uploadImg(element, tag) {
                    var file = tag.files[0];
                    var imgSrc;
                    if (!/image\/\w+/.test(file.type)) {
                        alert("看清楚，这个需要图片！");
                        return false;
                    }
                    var reader = new FileReader();
                    reader.readAsDataURL(file);
                    reader.onload = function() {
                        imgSrc = this.result;
                        switch(element) {
                            case '#Bank-card-photo': //logo图片路径
                                state.facadeImg = imgSrc;
                                $(".bottom-right-img").attr("src", imgSrc);
                                break;
                            case '#Bank-card-photos': //二维码图片保存
                                state.facadeImgUrl = imgSrc;
                                $(".bottom-right-imgs").attr("src", imgSrc);
                                break;
                            default:
                                alert("传图有误，请重新上传图片");
                        }
                    };
                }

                //提交
                $("#sumbit").bind('click', function () {
                    const {companyName, contactInfo, contactAddress,
                        myPageName, myPageName1,myPageName2, myPageName3, myPageName4, myPageName5,
                        mySkipJoin, mySkipJoin1, mySkipJoin2, mySkipJoin3, mySkipJoin4, mySkipJoin5,
                        friendPageName, friendPageName1, friendSkipJoin, friendSkipJoin1, facadeImg, facadeImgUrl} = state;
                    if (!(/^([\u2E80-\u9FFF]+){6}$/.test(companyName))) {
                        alert('公司名称最少为6个中文字')
                    } else if (!(/^1[34578]\d{9}$/.test(contactInfo))) {
                        alert('联络方式有误')
                    } else if (contactAddress.length < 4) {
                        alert('联络地址最少为4个字')
                    } else {
                        $.post(
                            url.addCententTitle,
                            data = {
                                comp_name: companyName,
                                intro: '您好!',
                                link_phone: contactInfo,
                                address: contactAddress,
                                page_name1: myPageName,
                                page_link1: mySkipJoin,
                                page_name2: myPageName1,
                                page_link2: mySkipJoin1,
                                page_name3: myPageName2,
                                page_link3: mySkipJoin2,
                                page_name4: myPageName3,
                                page_link4: mySkipJoin3,
                                page_name5: myPageName4,
                                page_link5: mySkipJoin4,
                                page_name6: myPageName5,
                                page_link6: mySkipJoin5,
                                friend_page1: friendPageName,
                                friend_link1: friendSkipJoin,
                                friend_page2: friendPageName1,
                                friend_link2: friendSkipJoin1,
                                pic_rul: facadeImg,
                            },
                            function(res) {
                                if (res) {
                                    alert(res.message);
                                }
                            })
                    }
                })
            })
        </script>
    </div>
{{/default}}
